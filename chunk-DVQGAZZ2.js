import"./chunk-DFQXWF2C.js";import{a as J}from"./chunk-TYIT34KR.js";import"./chunk-6LTELVWP.js";import"./chunk-TKL5HFB3.js";import"./chunk-AQ7FFUGL.js";import"./chunk-ZYQ7KRKH.js";import{b as V,c as s,d as A,e as G,g as W,h as O,k as B,l as K,m as L,n as U,o as $,q as j,r as z,s as H}from"./chunk-5VRDLXRS.js";import"./chunk-TZMPXKHX.js";import"./chunk-OFIQSEYL.js";import"./chunk-GF7BQK6Q.js";import"./chunk-XAZ3CRE3.js";import{Cb as w,Eb as x,Ec as q,Gb as b,Pa as d,Sb as M,Tb as i,Ub as h,Vb as D,Wa as T,Wb as v,_ as P,_a as I,da as f,ea as R,jc as N,nb as C,oa as g,pb as E,rb as F,sb as k,tb as _,ub as t,vb as e,wb as c}from"./chunk-JKZ4R3JY.js";import"./chunk-2NFLSA4Y.js";function Q(){let a=P(J),n=g([]),r=g(!1),m=g(null),p=g(null),y=g(!1),Y=N(()=>n().filter(o=>o.isActive)),Z=N(()=>{let o=new Map;return n().forEach(l=>{let u=l.serviceType;o.has(u)||o.set(u,[]),o.get(u).push(l)}),o}),S=async()=>{r.set(!0);try{let o=await a.apiRatesGet();n.set(o||[])}catch(o){console.error("Error loading rates:",o)}finally{r.set(!1)}},ee=async o=>{try{let l=await a.apiRatesPost(o);return await S(),l}catch(l){throw console.error("Error creating rate:",l),l}},te=async(o,l)=>{try{let u=await a.apiRatesRateIdPatch(o,l);return await S(),u}catch(u){throw console.error("Error updating rate:",u),u}},ie=async o=>{try{await a.apiRatesRateIdDelete(o),n.update(l=>l.filter(u=>u.id!==o))}catch(l){throw console.error("Error deleting rate:",l),l}},re=async o=>{y.set(!0);try{let l=await a.apiRatesCalculatePost(o);return p.set(l),l}catch(l){throw console.error("Error calculating rate:",l),l}finally{y.set(!1)}},ne=o=>{m.set(o)};return{rates:n.asReadonly(),activeRates:Y,ratesByService:Z,isLoading:r.asReadonly(),isCalculating:y.asReadonly(),selectedRate:m.asReadonly(),calculationResult:p.asReadonly(),loadRates:S,createRate:ee,updateRate:te,deleteRate:ie,calculateRate:re,selectRate:ne}}var ae=(a,n)=>n.id;function oe(a,n){if(a&1){let r=w();t(0,"button",36),x("click",function(){f(r);let p=b();return R(p.cancelEdit())}),i(1," Cancel "),e()}}function le(a,n){a&1&&(t(0,"div",33),i(1,"Loading rates..."),e())}function de(a,n){a&1&&(t(0,"div",34),i(1," No rates configured yet. Create your first rate above. "),e())}function se(a,n){if(a&1){let r=w();t(0,"tr",41)(1,"td",42),i(2),e(),t(3,"td",43),i(4),e(),t(5,"td",43),i(6),e(),t(7,"td",43),i(8),e(),t(9,"td",43),i(10),e(),t(11,"td",43),i(12),e(),t(13,"td",44)(14,"span",45),i(15),e()(),t(16,"td",44)(17,"div",46)(18,"button",47),x("click",function(){let p=f(r).$implicit,y=b(2);return R(y.editRate(p))}),i(19," Edit "),e(),t(20,"button",48),x("click",function(){let p=f(r).$implicit,y=b(2);return R(y.deleteRate(p.id))}),i(21," Delete "),e()()()()}if(a&2){let r=n.$implicit;d(2),h(r.serviceType),d(2),h(r.shipmentType),d(2),v(" ",r.originCountry||"Any"," \u2192 ",r.destinationCountry||"Any"," "),d(2),v("",r.minWeight," - ",r.maxWeight," kg"),d(2),v("",r.currency," ",r.basePrice),d(2),v("",r.currency," ",r.pricePerKg),d(2),M(r.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),d(),D(" ",r.isActive?"Active":"Inactive"," ")}}function me(a,n){if(a&1&&(t(0,"div",35)(1,"table",37)(2,"thead",38)(3,"tr")(4,"th",39),i(5,"Service"),e(),t(6,"th",39),i(7,"Type"),e(),t(8,"th",39),i(9,"Route"),e(),t(10,"th",39),i(11,"Weight Range"),e(),t(12,"th",39),i(13,"Base Price"),e(),t(14,"th",39),i(15,"Per KG"),e(),t(16,"th",39),i(17,"Status"),e(),t(18,"th",39),i(19,"Actions"),e()()(),t(20,"tbody",40),F(21,se,22,13,"tr",41,ae),e()()()),a&2){let r=b();d(21),k(r.rateData.rates())}}var X=class a{constructor(n){this.fb=n;this.rateForm=this.fb.group({serviceType:["Standard",s.required],shipmentType:["Package",s.required],originCountry:[""],destinationCountry:[""],minWeight:[0,[s.required,s.min(0)]],maxWeight:[100,[s.required,s.min(.1)]],basePrice:[0,[s.required,s.min(0)]],pricePerKg:[0,[s.required,s.min(0)]],volumetricDivisor:[5e3,[s.required,s.min(1)]],fuelSurchargePercent:[10,[s.required,s.min(0)]],remoteSurcharge:[0],currency:["USD",s.required]})}rateData=Q();rateForm;isEditing=g(!1);editingRateId=g(null);async ngOnInit(){await this.rateData.loadRates()}async onSubmit(){if(this.rateForm.valid)try{let n=this.rateForm.value;this.isEditing()&&this.editingRateId()?await this.rateData.updateRate(this.editingRateId(),n):await this.rateData.createRate(n),this.rateForm.reset({serviceType:"Standard",shipmentType:"Package",volumetricDivisor:5e3,fuelSurchargePercent:10,currency:"USD"}),this.isEditing.set(!1),this.editingRateId.set(null)}catch(n){console.error("Error saving rate:",n)}}editRate(n){this.rateForm.patchValue(n),this.isEditing.set(!0),this.editingRateId.set(n.id)}cancelEdit(){this.rateForm.reset({serviceType:"Standard",shipmentType:"Package",volumetricDivisor:5e3,fuelSurchargePercent:10,currency:"USD"}),this.isEditing.set(!1),this.editingRateId.set(null)}async deleteRate(n){if(confirm("Are you sure you want to delete this rate?"))try{await this.rateData.deleteRate(n)}catch(r){console.error("Error deleting rate:",r)}}static \u0275fac=function(r){return new(r||a)(T(j))};static \u0275cmp=I({type:a,selectors:[["app-rates"]],decls:84,vars:6,consts:[[1,"p-6"],[1,"mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600","mt-1"],[1,"bg-white","p-6","rounded-lg","shadow","mb-6"],[1,"text-lg","font-semibold","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["formControlName","serviceType",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["value","Standard"],["value","Express"],["value","Overnight"],["formControlName","shipmentType",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["value","Document"],["value","Package"],["type","text","formControlName","currency",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["type","text","formControlName","originCountry",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","text","formControlName","destinationCountry",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","number","step","0.1","formControlName","minWeight",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","number","step","0.1","formControlName","maxWeight",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","number","step","0.01","formControlName","basePrice",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","number","step","0.01","formControlName","pricePerKg",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","number","formControlName","volumetricDivisor",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","number","step","0.1","formControlName","fuelSurchargePercent",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","number","step","0.01","formControlName","remoteSurcharge",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],[1,"flex","justify-end","gap-4"],["type","button",1,"px-6","py-2","border","border-gray-300","rounded-lg","hover:bg-gray-50"],["type","submit",1,"px-6","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:opacity-50",3,"disabled"],[1,"bg-white","rounded-lg","shadow"],[1,"p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-center","py-12"],[1,"text-center","py-12","text-gray-500"],[1,"overflow-x-auto"],["type","button",1,"px-6","py-2","border","border-gray-300","rounded-lg","hover:bg-gray-50",3,"click"],[1,"w-full"],[1,"bg-gray-50","border-b"],[1,"px-6","py-3","text-left","text-sm","font-medium","text-gray-700"],[1,"divide-y","divide-gray-200"],[1,"hover:bg-gray-50"],[1,"px-6","py-4","text-sm","font-medium"],[1,"px-6","py-4","text-sm"],[1,"px-6","py-4"],[1,"px-3","py-1","rounded-full","text-xs","font-medium"],[1,"flex","gap-2"],[1,"text-blue-600","hover:text-blue-800","text-sm",3,"click"],[1,"text-red-600","hover:text-red-800","text-sm",3,"click"]],template:function(r,m){r&1&&(t(0,"div",0)(1,"div",1)(2,"h1",2),i(3,"Rates & Pricing"),e(),t(4,"p",3),i(5,"Configure shipping rates for your services"),e()(),t(6,"div",4)(7,"h2",5),i(8),e(),t(9,"form",6),x("ngSubmit",function(){return m.onSubmit()}),t(10,"div",7)(11,"div")(12,"label",8),i(13,"Service Type *"),e(),t(14,"select",9)(15,"option",10),i(16,"Standard"),e(),t(17,"option",11),i(18,"Express"),e(),t(19,"option",12),i(20,"Overnight"),e()()(),t(21,"div")(22,"label",8),i(23,"Shipment Type *"),e(),t(24,"select",13)(25,"option",14),i(26,"Document"),e(),t(27,"option",15),i(28,"Package"),e()()(),t(29,"div")(30,"label",8),i(31,"Currency *"),e(),c(32,"input",16),e()(),t(33,"div",17)(34,"div")(35,"label",8),i(36,"Origin Country"),e(),c(37,"input",18),e(),t(38,"div")(39,"label",8),i(40,"Destination Country"),e(),c(41,"input",19),e()(),t(42,"div",17)(43,"div")(44,"label",8),i(45,"Min Weight (kg) *"),e(),c(46,"input",20),e(),t(47,"div")(48,"label",8),i(49,"Max Weight (kg) *"),e(),c(50,"input",21),e()(),t(51,"div",7)(52,"div")(53,"label",8),i(54,"Base Price *"),e(),c(55,"input",22),e(),t(56,"div")(57,"label",8),i(58,"Price per KG *"),e(),c(59,"input",23),e(),t(60,"div")(61,"label",8),i(62,"Volumetric Divisor *"),e(),c(63,"input",24),e()(),t(64,"div",17)(65,"div")(66,"label",8),i(67,"Fuel Surcharge (%) *"),e(),c(68,"input",25),e(),t(69,"div")(70,"label",8),i(71,"Remote Surcharge"),e(),c(72,"input",26),e()(),t(73,"div",27),C(74,oe,2,0,"button",28),t(75,"button",29),i(76),e()()()(),t(77,"div",30)(78,"div",31)(79,"h2",32),i(80,"Configured Rates"),e()(),C(81,le,2,0,"div",33)(82,de,2,0,"div",34)(83,me,23,0,"div",35),e()()),r&2&&(d(8),h(m.isEditing()?"Edit Rate":"Create New Rate"),d(),_("formGroup",m.rateForm),d(65),E(m.isEditing()?74:-1),d(),_("disabled",!m.rateForm.valid),d(),D(" ",m.isEditing()?"Update Rate":"Create Rate"," "),d(5),E(m.rateData.isLoading()?81:m.rateData.rates().length===0?82:83))},dependencies:[q,z,W,U,$,V,O,L,A,G,H,K,B],encapsulation:2,changeDetection:0})};export{X as RatesComponent};
