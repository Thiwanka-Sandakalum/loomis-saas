import"./chunk-DFQXWF2C.js";import"./chunk-TYIT34KR.js";import"./chunk-6LTELVWP.js";import"./chunk-TKL5HFB3.js";import"./chunk-AQ7FFUGL.js";import"./chunk-ZYQ7KRKH.js";import{b as P,c as l,d as R,e as k,g as A,h as I,k as G,l as L,m as O,n as V,o as j,q as B,r as U,s as W}from"./chunk-5VRDLXRS.js";import"./chunk-TZMPXKHX.js";import{c as M}from"./chunk-TKVNSRWZ.js";import"./chunk-W2ZFWDSY.js";import{a as z}from"./chunk-OFIQSEYL.js";import"./chunk-GF7BQK6Q.js";import"./chunk-XAZ3CRE3.js";import{Eb as x,Ec as _,Gb as T,Pa as g,Tb as i,Vb as q,Wa as b,_ as D,_a as F,jc as E,nb as S,oa as c,pb as v,tb as C,ub as n,vb as e,wb as d}from"./chunk-JKZ4R3JY.js";import{a as y,b as w}from"./chunk-2NFLSA4Y.js";function H(){let m=D(z),a=c([]),s=c({}),p=c(!1),h=c(null),f=c(!1),K=E(()=>{let r=a(),t=s();if(t.status&&t.status.length>0&&(r=r.filter(o=>t.status.includes(o.status))),t.serviceType&&t.serviceType.length>0&&(r=r.filter(o=>t.serviceType.includes(o.serviceType))),t.search){let o=t.search.toLowerCase();r=r.filter(u=>u.trackingNumber.toLowerCase().includes(o)||u.senderName.toLowerCase().includes(o)||u.receiverName.toLowerCase().includes(o)||u.customerReference?.toLowerCase().includes(o))}return t.dateFrom&&(r=r.filter(o=>new Date(o.createdAt)>=t.dateFrom)),t.dateTo&&(r=r.filter(o=>new Date(o.createdAt)<=t.dateTo)),r}),Q=E(()=>{let r=a();return{total:r.length,created:r.filter(t=>t.status==="Created").length,inTransit:r.filter(t=>t.status==="InTransit"||t.status==="PickedUp").length,delivered:r.filter(t=>t.status==="Delivered").length,cancelled:r.filter(t=>t.status==="Cancelled").length}}),N=async()=>{p.set(!0);try{let r=await m.apiShipmentsGet();a.set(r||[])}catch(r){console.error("Error loading shipments:",r)}finally{p.set(!1)}},X=async r=>{try{return await m.apiShipmentsTrackingTrackingNumberGet(r)}catch(t){throw console.error("Error loading shipment:",t),t}},Y=async r=>{f.set(!0);try{let t=await m.apiShipmentsPost(r);return await N(),t}catch(t){throw console.error("Error creating shipment:",t),t}finally{f.set(!1)}},Z=async(r,t)=>{try{console.log("Updating shipment status:",r,t),a.update(o=>o.map(u=>u.trackingNumber===r?w(y({},u),{status:t,updatedAt:new Date}):u))}catch(o){throw console.error("Error updating shipment status:",o),o}},$=r=>{s.update(t=>y(y({},t),r))},ee=r=>{h.set(r)},te=async r=>{try{a.update(t=>t.filter(o=>o.trackingNumber!==r))}catch(t){throw console.error("Error deleting shipment:",t),t}};return{shipments:a.asReadonly(),filteredShipments:K,filters:s.asReadonly(),isLoading:p.asReadonly(),isCreating:f.asReadonly(),selectedShipment:h.asReadonly(),stats:Q,loadShipments:N,loadShipmentByTracking:X,createShipment:Y,updateShipmentStatus:Z,updateFilters:$,selectShipment:ee,deleteShipment:te}}function re(m,a){if(m&1&&(n(0,"div",4),i(1),e()),m&2){let s=T();g(),q(" ",s.errorMessage()," ")}}function ne(m,a){m&1&&i(0," Creating... ")}function ie(m,a){m&1&&i(0," Create Shipment ")}var J=class m{constructor(a,s){this.fb=a;this.router=s;this.shipmentForm=this.fb.group({shipmentType:["Package",l.required],serviceType:["Standard",l.required],weight:[0,[l.required,l.min(.1)]],customerReference:[""],senderName:["",l.required],senderPhone:["",l.required],senderAddress1:["",l.required],senderCity:["",l.required],senderPostalCode:["",l.required],senderCountry:["",l.required],receiverName:["",l.required],receiverPhone:["",l.required],receiverAddress1:["",l.required],receiverCity:["",l.required],receiverPostalCode:["",l.required],receiverCountry:["",l.required]})}shipmentData=H();shipmentForm;errorMessage=c(null);ngOnInit(){}async onSubmit(){if(this.shipmentForm.valid)try{let a=this.shipmentForm.value,s=await this.shipmentData.createShipment(a);this.router.navigate(["/shipments"])}catch(a){this.errorMessage.set(a.message||"Failed to create shipment")}}onCancel(){this.router.navigate(["/shipments"])}static \u0275fac=function(s){return new(s||m)(b(B),b(M))};static \u0275cmp=F({type:m,selectors:[["app-shipment-create"]],decls:100,vars:4,consts:[[1,"p-6","max-w-4xl","mx-auto"],[1,"mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600","mt-1"],[1,"bg-red-50","border","border-red-200","text-red-800","px-4","py-3","rounded-lg","mb-6"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"bg-white","p-6","rounded-lg","shadow"],[1,"text-lg","font-semibold","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["formControlName","shipmentType",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["value","Document"],["value","Package"],["formControlName","serviceType",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["value","Standard"],["value","Express"],["value","Overnight"],["type","number","step","0.1","formControlName","weight",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","text","formControlName","customerReference",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","text","formControlName","senderName",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","tel","formControlName","senderPhone",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],[1,"md:col-span-2"],["type","text","formControlName","senderAddress1",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","text","formControlName","senderCity",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","text","formControlName","senderPostalCode",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","text","formControlName","senderCountry",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","text","formControlName","receiverName",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","tel","formControlName","receiverPhone",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","text","formControlName","receiverAddress1",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","text","formControlName","receiverCity",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","text","formControlName","receiverPostalCode",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],["type","text","formControlName","receiverCountry",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-2"],[1,"flex","justify-end","gap-4"],["type","button",1,"px-6","py-2","border","border-gray-300","rounded-lg","hover:bg-gray-50",3,"click"],["type","submit",1,"px-6","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:opacity-50",3,"disabled"]],template:function(s,p){s&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),i(3,"Create New Shipment"),e(),n(4,"p",3),i(5,"Fill in the details to book a new delivery"),e()(),S(6,re,2,1,"div",4),n(7,"form",5),x("ngSubmit",function(){return p.onSubmit()}),n(8,"div",6)(9,"h2",7),i(10,"Shipment Details"),e(),n(11,"div",8)(12,"div")(13,"label",9),i(14,"Shipment Type *"),e(),n(15,"select",10)(16,"option",11),i(17,"Document"),e(),n(18,"option",12),i(19,"Package"),e()()(),n(20,"div")(21,"label",9),i(22,"Service Type *"),e(),n(23,"select",13)(24,"option",14),i(25,"Standard"),e(),n(26,"option",15),i(27,"Express"),e(),n(28,"option",16),i(29,"Overnight"),e()()(),n(30,"div")(31,"label",9),i(32,"Weight (kg) *"),e(),d(33,"input",17),e(),n(34,"div")(35,"label",9),i(36,"Customer Reference"),e(),d(37,"input",18),e()()(),n(38,"div",6)(39,"h2",7),i(40,"Sender Information"),e(),n(41,"div",8)(42,"div")(43,"label",9),i(44,"Name *"),e(),d(45,"input",19),e(),n(46,"div")(47,"label",9),i(48,"Phone *"),e(),d(49,"input",20),e(),n(50,"div",21)(51,"label",9),i(52,"Address *"),e(),d(53,"input",22),e(),n(54,"div")(55,"label",9),i(56,"City *"),e(),d(57,"input",23),e(),n(58,"div")(59,"label",9),i(60,"Postal Code *"),e(),d(61,"input",24),e(),n(62,"div")(63,"label",9),i(64,"Country *"),e(),d(65,"input",25),e()()(),n(66,"div",6)(67,"h2",7),i(68,"Receiver Information"),e(),n(69,"div",8)(70,"div")(71,"label",9),i(72,"Name *"),e(),d(73,"input",26),e(),n(74,"div")(75,"label",9),i(76,"Phone *"),e(),d(77,"input",27),e(),n(78,"div",21)(79,"label",9),i(80,"Address *"),e(),d(81,"input",28),e(),n(82,"div")(83,"label",9),i(84,"City *"),e(),d(85,"input",29),e(),n(86,"div")(87,"label",9),i(88,"Postal Code *"),e(),d(89,"input",30),e(),n(90,"div")(91,"label",9),i(92,"Country *"),e(),d(93,"input",31),e()()(),n(94,"div",32)(95,"button",33),x("click",function(){return p.onCancel()}),i(96," Cancel "),e(),n(97,"button",34),S(98,ne,1,0)(99,ie,1,0),e()()()()),s&2&&(g(6),v(p.errorMessage()?6:-1),g(),C("formGroup",p.shipmentForm),g(90),C("disabled",p.shipmentData.isCreating()||!p.shipmentForm.valid),g(),v(p.shipmentData.isCreating()?98:99))},dependencies:[_,U,A,V,j,P,I,O,R,k,W,L,G],encapsulation:2,changeDetection:0})};export{J as ShipmentCreateComponent};
