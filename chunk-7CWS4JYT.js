import{c as a,q as w,r as k,s as A}from"./chunk-5VRDLXRS.js";import{Ec as f,Tb as g,Wa as h,_a as b,oa as s,xb as c,yb as l}from"./chunk-JKZ4R3JY.js";import{a as u,b as y}from"./chunk-2NFLSA4Y.js";function v(){let i=s(null),e=s([]),o=s(!1),n=s(!1),m=s(!1),S=async()=>{o.set(!0);try{let r={id:"1",tenantId:"tenant-1",companyName:"Acme Logistics",primaryColor:"#3B82F6",accentColor:"#10B981",brandingTone:"Professional",telegramEnabled:!1,whatsappEnabled:!1,apiKeysEnabled:!0,emailNotifications:!0,smsNotifications:!1,webhookNotifications:!1,defaultCurrency:"USD",timezone:"America/New_York",updatedAt:new Date,updatedBy:"admin@example.com"};i.set(r)}catch(r){console.error("Error loading settings:",r)}finally{o.set(!1)}},d=async r=>{n.set(!0);try{return i.update(t=>t?y(u(u({},t),r),{updatedAt:new Date}):null),await new Promise(t=>setTimeout(t,500)),{success:!0,message:"Settings updated successfully"}}catch(t){throw console.error("Error updating settings:",t),t}finally{n.set(!1)}},p=async()=>{try{let r=[{id:"1",tenantId:"tenant-1",name:"Production API Key",key:"cmp_live_\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u20221234",prefix:"cmp_live_",isActive:!0,lastUsedAt:new Date,createdAt:new Date("2024-01-15"),createdBy:"admin@example.com"}];e.set(r)}catch(r){console.error("Error loading API keys:",r)}},D=async r=>{try{return console.log("Creating API key:",r),await new Promise(t=>setTimeout(t,500)),await p(),{success:!0,key:"cmp_live_1234567890abcdefghij",message:"API key created. Save it now - you won't see it again!"}}catch(t){throw console.error("Error creating API key:",t),t}},T=async r=>{try{e.update(t=>t.filter(x=>x.id!==r))}catch(t){throw console.error("Error revoking API key:",t),t}},K=async r=>{m.set(!0);try{return console.log("Testing webhook:",r),await new Promise(t=>setTimeout(t,1e3)),{success:!0,statusCode:200,message:"Webhook test successful",responseTime:245}}catch(t){throw console.error("Error testing webhook:",t),t}finally{m.set(!1)}},N=async r=>{try{return console.log("Configuring Telegram bot with token:",r.substring(0,10)+"..."),await new Promise(t=>setTimeout(t,1e3)),await d({telegramBotToken:r}),{success:!0,botUsername:"acme_courier_bot",message:"Telegram bot configured successfully"}}catch(t){throw console.error("Error configuring Telegram bot:",t),t}};return{settings:i.asReadonly(),apiKeys:e.asReadonly(),isLoading:o.asReadonly(),isSaving:n.asReadonly(),isTestingWebhook:m.asReadonly(),loadSettings:S,updateSettings:d,loadApiKeys:p,createApiKey:D,revokeApiKey:T,testWebhook:K,configureTelegramBot:N}}var F=["UTC","America/New_York","America/Chicago","America/Denver","America/Los_Angeles","Europe/London","Europe/Paris","Asia/Tokyo","Asia/Singapore","Australia/Sydney"],C=["USD","EUR","GBP","CAD","AUD","JPY","CNY","INR"];var E=class i{constructor(e){this.fb=e;this.brandingForm=this.fb.group({companyName:["",a.required],primaryColor:["#3B82F6"],accentColor:["#10B981"],brandingTone:["Professional"]}),this.telegramForm=this.fb.group({telegramBotToken:[""]}),this.webhookForm=this.fb.group({webhookUrl:["",a.pattern(/^https?:\/\/.+/)],webhookSecret:[""]}),this.notificationForm=this.fb.group({emailNotifications:[!0],smsNotifications:[!1],webhookNotifications:[!1]}),this.businessForm=this.fb.group({defaultCurrency:["USD",a.required],timezone:["America/New_York",a.required]}),this.createKeyForm=this.fb.group({name:["",a.required],expiresInDays:[null]})}settingsData=v();brandingForm;telegramForm;webhookForm;notificationForm;businessForm;createKeyForm;isCreateKeyModalOpen=s(!1);newApiKey=s(null);availableTimezones=F;availableCurrencies=C;async ngOnInit(){if(await this.settingsData.loadSettings(),await this.settingsData.loadApiKeys(),this.settingsData.settings()){let e=this.settingsData.settings();this.brandingForm.patchValue(e),this.telegramForm.patchValue({telegramBotToken:e.telegramBotToken||""}),this.webhookForm.patchValue(e),this.notificationForm.patchValue(e),this.businessForm.patchValue(e)}}async saveBranding(){if(this.brandingForm.valid)try{await this.settingsData.updateSettings(this.brandingForm.value)}catch(e){console.error("Error saving branding:",e)}}async configureTelegram(){let e=this.telegramForm.get("telegramBotToken")?.value;if(e)try{let o=await this.settingsData.configureTelegramBot(e);alert(`Telegram bot configured: @${o.botUsername}`)}catch(o){console.error("Error configuring Telegram:",o)}}async testWebhook(){let e=this.webhookForm.get("webhookUrl")?.value;if(e)try{let o=await this.settingsData.testWebhook(e);alert(`Webhook test ${o.success?"successful":"failed"}: ${o.message}`)}catch(o){console.error("Error testing webhook:",o)}}async saveWebhook(){if(this.webhookForm.valid)try{await this.settingsData.updateSettings(this.webhookForm.value)}catch(e){console.error("Error saving webhook:",e)}}async saveNotifications(){try{await this.settingsData.updateSettings(this.notificationForm.value)}catch(e){console.error("Error saving notifications:",e)}}async saveBusinessSettings(){if(this.businessForm.valid)try{await this.settingsData.updateSettings(this.businessForm.value)}catch(e){console.error("Error saving business settings:",e)}}showCreateKeyModal(){this.isCreateKeyModalOpen.set(!0),this.newApiKey.set(null),this.createKeyForm.reset()}closeCreateKeyModal(){this.isCreateKeyModalOpen.set(!1),this.newApiKey.set(null)}async createApiKey(){if(this.createKeyForm.valid)try{let e=await this.settingsData.createApiKey(this.createKeyForm.value);this.newApiKey.set(e.key)}catch(e){console.error("Error creating API key:",e)}}async revokeKey(e,o){if(confirm(`Are you sure you want to revoke "${o}"? This cannot be undone.`))try{await this.settingsData.revokeApiKey(e)}catch(n){console.error("Error revoking API key:",n)}}copyApiKey(){let e=this.newApiKey();e&&(navigator.clipboard.writeText(e),alert("API key copied to clipboard!"))}static \u0275fac=function(o){return new(o||i)(h(w))};static \u0275cmp=b({type:i,selectors:[["app-settings-hub"]],decls:8,vars:0,consts:[[1,"mx-auto","w-full","max-w-5xl","flex","flex-col","gap-8","pb-24"],[1,"text-3xl","font-bold","text-slate-900","dark:text-white"],[1,"text-slate-500"],[1,"rounded-xl","border","border-slate-200","bg-white","p-6","shadow-sm","dark:border-slate-800","dark:bg-slate-900"]],template:function(o,n){o&1&&(c(0,"div",0)(1,"h1",1),g(2,"Settings Hub"),l(),c(3,"p",2),g(4,"Configure your platform settings and integrations."),l(),c(5,"div",3)(6,"p"),g(7,"Settings hub under construction. Use main Settings page for configuration."),l()()())},dependencies:[f,k,A],encapsulation:2,changeDetection:0})};export{E as SettingsHubComponent};
